<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta content="width=device-width, initial-scale=1" name="viewport" />
<title>Seriesfav - Mejorado</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap'); 

:root {
  --bg: #f9fafb;
  --text: #111827;
  --card: #ffffff;
  --secondary: #4a90e2;
  --border: #e5e7eb;
  --radius: 16px;
  --transition: 0.3s ease;
} 

body.dark {
  --bg: #0b0b0b;
  --text: #e5e7eb;
  --card: #151515;
  --border: #2a2a2a;
} 

* {
  box-sizing: border-box;
} 

body {
  font-family: 'Inter', system-ui, -apple-system, Segoe UI, Roboto, Arial,
    sans-serif;
  background: var(--bg);
  background-image: radial-gradient(
    circle at center,
    rgba(74, 144, 226, 0.05),
    transparent 70%
  );
  color: var(--text);
  margin: 0;
  padding-top: 80px;
  transition: background 0.5s ease, color 0.5s ease;
  position: relative;
  min-height: 100vh;
} 

@keyframes fadeSlideUp {
  0% { opacity: 0; transform: translateY(20px); }
  100% { opacity: 1; transform: translateY(0); }
} 

.top-bar {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  background: var(--card);
  border-bottom: 1px solid var(--border);
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 0 1rem;
  gap: 1rem;
  z-index: 1000;
  flex-wrap: nowrap;
  height: 48px;
} 

.top-left,
.top-center,
.top-right {
  display: flex;
  align-items: center;
  height: 100%;
} 

.top-left {
  gap: 0.7rem;
  flex: 1 1 auto;
  justify-content: flex-start;
  min-width: 0;
  overflow: hidden;
} 

.top-left h1 {
  flex: 0 0 auto;
  font-size: 1.25rem;
  white-space: nowrap;
  margin: 0;
  font-weight: 600;
} 

#buscador {
  flex-grow: 1;
  max-width: 320px;
  min-width: 120px;
  padding: 0.4rem 2.5rem;
  border: 1px solid var(--border);
  border-radius: 9999px;
  background: var(--bg);
  color: var(--text);
  font-size: 0.9rem;
  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.08);
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='18' height='18' fill='none' stroke='%236b7280' stroke-width='2' viewBox='0 0 24 24'%3E%3Ccircle cx='11' cy='11' r='8'/%3E%3Cline x1='21' y1='21' x2='16.65' y2='16.65'/%3E%3C/svg%3E");
  background-repeat: no-repeat;
  background-position: 0.8rem center;
  background-size: 18px;
  transition: box-shadow var(--transition), background-color var(--transition), border-color var(--transition);
  overflow: hidden;
} 

#buscador:focus {
  outline: none;
  border-color: var(--secondary);
  box-shadow: 0 0 0 2px rgba(59,130,246,0.3), 0 0 16px rgba(59,130,246,0.7);
} 

body.dark #buscador:focus {
  box-shadow: 0 0 0 2px rgba(96,165,250,0.6), 0 0 20px rgba(37,99,235,0.9);
} 

.top-center {
  flex: 0 0 32px;
  justify-content: center;
  height: 100%;
} 

.toggle-dark {
  width: 32px;
  height: 32px;
  padding: 0.2rem 0.3rem;
  border: 1.5px solid var(--secondary);
  border-radius: 50%;
  cursor: pointer;
  outline: none;
  color: var(--secondary);
  background: var(--card);
  box-shadow: 0 1px 6px rgba(74, 144, 226, 0.4);
  transition: border-color 0.3s ease, color 0.3s ease,
    box-shadow 0.3s ease, transform 0.3s ease;
  display: flex;
  align-items: center;
  justify-content: center;
}
.toggle-dark:hover {
  border-color: #1e40af;
  color: #1e40af;
  box-shadow: 0 4px 14px rgba(30, 64, 175, 0.6);
  transform: scale(1.15);
}
.toggle-dark:active {
  transform: scale(1.05);
} 

.top-right {
  gap: 0.5rem;
  flex: 1 1 auto;
  justify-content: flex-end;
  min-width: 0;
  overflow: hidden;
} 

select {
  min-width: 120px;
  max-width: 150px;
  font-size: 0.9rem;
  margin-left: 0.5rem;
  padding: 0.4rem;
  border-radius: var(--radius);
  border: 1px solid var(--border);
  background: var(--bg);
  color: var(--text);
  transition: background-color var(--transition), border-color var(--transition), box-shadow var(--transition);
  appearance: none;
  background-image: url("data:image/svg+xml,%3Csvg fill='none' height='24' stroke='%236b7280' stroke-width='2' viewBox='0 0 24 24' width='24' xmlns='http://www.w3.org/2000/svg'%3E%3Cpolyline points='6 9 12 15 18 9'/%3E%3C/svg%3E");
  background-repeat: no-repeat;
  background-position: right 0.7rem center;
  background-size: 16px 16px;
  cursor: pointer;
} 

select:focus {
  outline: none;
  border-color: var(--secondary);
  box-shadow: 0 0 0 2px rgba(59,130,246,0.25), 0 0 14px rgba(59,130,246,0.6);
} 

body.dark select:focus {
  box-shadow: 0 0 0 2px rgba(96,165,250,0.6), 0 0 18px rgba(37,99,235,0.9);
} 

#contenido {
  max-width: 1400px;
  margin: 1rem auto 3rem;
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 1rem;
  justify-items: center;
} 

@media (min-width: 600px) {
  #contenido { grid-template-columns: repeat(4, 1fr); }
}
@media (min-width: 1024px) {
  #contenido { grid-template-columns: repeat(6, 1fr); }
} 

.item {
  background: var(--card);
  border-radius: 16px;
  border: 1px solid transparent;
  box-shadow: none;
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: 1rem;
  cursor: pointer;
  transition: transform 0.4s ease, box-shadow 0.4s ease,
    border-color 0.4s ease;
  position: relative;
  overflow: hidden;
  animation: fadeSlideUp 0.5s ease forwards;
} 

.item img {
  border-radius: 12px;
  width: 100%;
  aspect-ratio: 2/3;
  object-fit: cover;
  margin-bottom: 0.8rem;
  transition: transform 0.4s ease;
} 

.item h4 {
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  font-weight: 700;
  font-size: 1.15rem;
  letter-spacing: 0.03em;
  color: var(--text);
  text-align: center;
  margin: 0 0 0.25rem 0;
  user-select: none;
} 

.fecha-estreno {
  font-size: 0.75rem;
  color: var(--secondary);
  margin-bottom: 0.6rem;
  text-align: center;
  font-weight: 500;
} 

.item-footer {
  display: flex;
  align-items: center;
  gap: 0.6rem;
  margin-top: 0.4rem;
  flex-wrap: wrap;
  justify-content: center;
  width: 100%;
} 

.descripcion-btn {
  background: var(--secondary);
  color: #fff;
  border: none;
  padding: 0.45rem 1rem;
  border-radius: 9999px;
  font-weight: 600;
  font-size: 0.85rem;
  box-shadow: 0 2px 8px rgba(74, 144, 226, 0.4);
  transition: background-color 0.3s ease, box-shadow 0.3s ease,
    transform 0.3s ease;
  flex: 1 1 auto;
  max-width: 110px;
  cursor: pointer;
} 

.descripcion-btn:hover,
.descripcion-btn:focus {
  background: #357acc;
  box-shadow: 0 4px 14px rgba(53, 122, 204, 0.7);
  transform: translateY(-2px) scale(1.05);
} 

.estado-serie {
  display: inline-flex;
  align-items: center;
  gap: 0.5rem;
  padding: 0.15rem 0.7rem;
  border-radius: 9999px;
  font-weight: 600;
  font-size: 0.8rem;
  user-select: none;
  cursor: default;
  box-shadow: 0 0 8px rgba(0, 0, 0, 0.1);
  color: inherit;
  background-color: #f0f0f0;
  transition: background-color 0.3s ease;
  flex: 0 0 auto;
  white-space: nowrap;
} 

.estado-serie::before {
  content: '';
  display: inline-block;
  width: 12px;
  height: 12px;
  border-radius: 50%;
  background-color: currentColor;
  box-shadow: 0 0 4px rgba(0, 0, 0, 0.2);
} 

@keyframes shine-light {
  0% { background-position: -200% 0; }
  100% { background-position: 200% 0; }
}
@keyframes shine-dark {
  0% { background-position: -200% 0; }
  100% { background-position: 200% 0; }
} 

.item:hover,
.item:focus-visible {
  transform: translateY(-6px) scale(1.03);
  border-color: var(--secondary);
  box-shadow: 0 0 20px 4px rgba(74, 144, 226, 0.45);
  outline: none;
  position: relative;
  z-index: 2;
  cursor: pointer; 
  background-size: 200% 100%;
  animation: shine-light 1.5s linear infinite;
  background-image: linear-gradient(120deg, var(--card), #e0f0ff, var(--card));
} 

body.dark .item:hover,
body.dark .item:focus-visible {
  box-shadow: 0 0 30px 6px rgba(74, 144, 226, 0.8);
  background-image: linear-gradient(120deg, var(--card), #3b82f6, var(--card));
  animation: shine-dark 1.5s linear infinite;
} 

.item:active {
  transform: translateY(-3px) scale(1.02);
  border-color: var(--secondary);
  box-shadow: 0 0 25px 5px rgba(74, 144, 226, 0.6);
  animation-play-state: paused;
  background: linear-gradient(120deg, var(--card), #d6eaff, var(--card));
} 

body.dark .item:active {
  background: linear-gradient(120deg, var(--card), #2563eb, var(--card));
} 

.item:hover img,
.item:focus-visible img,
.item:active img {
  transform: scale(1.05);
} 

.item img.loading {
  background: linear-gradient(
    90deg,
    #e5e7eb 25%,
    #f3f4f6 50%,
    #e5e7eb 75%
  );
  background-size: 200% 100%;
  animation: skeleton 1.2s infinite;
} 

.top-bar {
  padding: 0.2rem 0.5rem !important;
  gap: 0.35rem !important;
}
.top-bar h1 {
  font-size: 1rem !important;
  margin: 0 0.4rem 0 0 !important;
}
#contenido {
  margin-top: 64px !important;
} 

.modal-overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
  background: rgba(0, 0, 0, 0.3);
  backdrop-filter: blur(6px);
  display: none;
  align-items: center;
  justify-content: center;
  z-index: 1500;
  padding: 1.5rem;
  overflow-y: auto;
  flex-direction: column;
} 

.modal-wrapper {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 0.5rem;
  max-width: 600px;
  width: 100%;
} 

.modal {
  background: var(--card);
  color: var(--text);
  border-radius: var(--radius);
  width: 100%;
  padding: 1rem 1.5rem 1.5rem;
  max-height: 90vh;
  overflow-y: auto;
  position: relative;
  box-shadow: 0 12px 36px rgba(0, 0, 0, 0.2);
  display: flex;
  flex-direction: column;
} 

.modal img {
  width: 100%;
  border-radius: var(--radius);
  margin-bottom: 0.8rem;
  object-fit: contain;
  max-height: 70vh;
  display: block;
  position: relative;
  cursor: pointer;
} 

/* contenedor para vídeo responsive cuando se reemplaza */
.modal-video {
  width: 100%;
  border-radius: var(--radius);
  overflow: hidden;
  margin-bottom: 0.8rem;
} 

.modal-video iframe {
  width: 100%;
  aspect-ratio: 16 / 9;
  border: none;
  display: block;
} 

/* botones navegación modal */
.modal-nav {
  margin-top: 0.5rem;
  display: flex;
  justify-content: center;
  gap: 1.5rem;
  width: 100%;
} 

.modal-nav button {
  width: 45px;
  height: 45px;
  border-radius: 50%;
  border: 2px solid var(--border);
  background: rgba(255, 255, 255, 0.85);
  box-shadow: 0 1px 6px rgba(0,0,0,0.1);
  transition: background 0.3s ease, color 0.3s ease, transform 0.3s ease;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: 700;
  font-size: 1.25rem;
  color: var(--text);
} 

.modal-nav button:hover {
  background: rgba(74,144,226,0.9);
  color: white;
  transform: scale(1.1);
} 

body.dark .modal-nav button {
  background: #1f2937;
  border-color: #3b82f6;
  color: #bfdbfe;
  box-shadow: 0 0 8px #3b82f6aa;
} 

body.dark .modal-nav button:hover {
  background: #3b82f6;
  color: #111827;
  box-shadow: 0 0 12px #3b82f6ff;
  transform: scale(1.15);
} 

@media (max-width: 600px) {
  .top-bar {
    flex-wrap: wrap;
    justify-content: center;
    padding: 0.5rem 0.75rem;
    height: auto;
  }
  .top-left,
  .top-right {
    flex: 1 1 100%;
    justify-content: center;
    margin-bottom: 0.4rem;
  }
  .top-left { gap: 0.5rem; }
  .top-right { gap: 0.5rem; } 

  #buscador {
    max-width: 100%;
    min-width: 0;
    width: 100%;
    box-sizing: border-box;
  } 

  select {
    font-size: 1rem;
    padding: 0.4rem 0.6rem;
    height: 2.1rem;
    width: 95%;
    max-width: none;
  } 

  .top-center {
    order: 0;
    width: 100%;
    margin-bottom: 0.5rem;
    justify-content: center;
  }
  .toggle-dark {
    width: 32px;
    height: 32px;
    padding: 0.2rem 0.3rem;
  }
  .top-left h1 {
    font-size: 1.2rem;
  }
  .item-footer {
    justify-content: center;
  }
}
</style>
</head>
<body>
  <div class="top-bar" role="banner" aria-label="Barra de navegación principal">
    <div class="top-left">
      <h1>Seriesfav</h1>
      <input
        id="buscador"
        aria-label="Buscar series"
        oninput="filtrarSeries()"
        placeholder="Buscar..."
        type="text"
      />
    </div> 

    <div class="top-center">
      <button
        class="toggle-dark"
        id="theme-toggle"
        onclick="toggleTheme()"
        aria-label="Cambiar tema"
        title="Cambiar tema"
      >
        <svg
          id="icon-moon"
          width="20"
          height="20"
          viewBox="0 0 24 24"
          fill="currentColor"
          aria-hidden="true"
          focusable="false"
        >
          <path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/>
        </svg>
        <svg
          id="icon-sun"
          width="20"
          height="20"
          viewBox="0 0 24 24"
          fill="currentColor"
          style="display:none"
          aria-hidden="true"
          focusable="false"
        >
          <circle cx="12" cy="12" r="5" />
          <g stroke="currentColor" stroke-width="2">
            <line x1="12" y1="1" x2="12" y2="4" />
            <line x1="12" y1="20" x2="12" y2="23" />
            <line x1="1" y1="12" x2="4" y2="12" />
            <line x1="20" y1="12" x2="23" y2="12" />
            <line x1="4.2" y1="4.2" x2="6.4" y2="6.4" />
            <line x1="17.6" y1="17.6" x2="19.8" y2="19.8" />
            <line x1="4.2" y1="19.8" x2="6.4" y2="17.6" />
            <line x1="17.6" y1="6.4" x2="19.8" y2="4.2" />
          </g>
        </svg>
      </button>
    </div> 

    <div class="top-right">
      <select
        id="filtro-seccion"
        aria-label="Filtrar por sección"
        onchange="filtrarSeries()"
      >
        <option value="">Todas las secciones</option>
        <option value="vistas">Vistas</option>
        <option value="no-vistas">No vistas</option>
        <option value="proximas">Próximas</option>
      </select>
      <select
        id="filtro-plataforma"
        aria-label="Filtrar por plataforma"
        onchange="filtrarSeries()"
      >
        <option value="">Todas las plataformas</option>
        <option>Netflix</option>
        <option>Disney Plus</option>
        <option>Apple TV</option>
        <option>HBO Max</option>
        <option>Prime</option>
        <option>Pelis</option>
        <option>Otras</option>
      </select>
    </div>
  </div> 

  <main id="contenido" role="main"></main> 

  <div
    id="overlay"
    class="modal-overlay"
    role="dialog"
    aria-modal="true"
    aria-labelledby="modal-title"
    aria-describedby="modal-desc"
  >
    <div class="modal-wrapper">
      <div class="modal">
        <div id="modal-content" tabindex="0" style="outline:none"></div>
      </div>
      <div class="modal-nav">
        <button onclick="navegarModal(-1)" aria-label="Serie anterior" title="Anterior">
          <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true" focusable="false">
            <polyline points="15 18 9 12 15 6" />
          </svg>
        </button>
        <button onclick="navegarModal(1)" aria-label="Serie siguiente" title="Siguiente">
          <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true" focusable="false">
            <polyline points="9 18 15 12 9 6" />
          </svg>
        </button>
        <button onclick="cerrarModal()" aria-label="Cerrar modal" title="Cerrar">X</button>
      </div>
    </div>
  </div> 

  <script>
    // URL del JSON en GitHub (cámbiala por la tuya)
    // Ejemplo con GitHub Pages: 
    // Ejemplo con raw: 'https://raw.githubusercontent.com/usuario/repositorio/rama/series.json'
    const URL_JSON = https://raw.githubusercontent.com/keiriblest/SeriesFav/refs/heads/main/series-datos%20(1).json

    let datos = [];
    let indiceModal = 0;

    function toggleTheme() {
      document.body.classList.toggle('dark');
      const iconMoon = document.getElementById('icon-moon');
      const iconSun = document.getElementById('icon-sun');
      if (document.body.classList.contains('dark')) {
        iconMoon.style.display = 'none';
        iconSun.style.display = 'inline';
      } else {
        iconMoon.style.display = 'inline';
        iconSun.style.display = 'none';
      }
    } 

    function renderSeries(lista) {
      const cont = document.getElementById('contenido');
      cont.innerHTML = '';
      lista.forEach((serie, i) => {
        const card = document.createElement('div');
        card.className = 'item'; 

        const img = document.createElement('img');
        img.src = serie.imgURL;
        img.alt = serie.titulo;
        card.appendChild(img); 

        const title = document.createElement('h4');
        title.textContent = serie.titulo;
        card.appendChild(title); 

        if (serie.seccion === 'proximas' && serie.fecha) {
          const fecha = document.createElement('div');
          fecha.className = 'fecha-estreno';
          fecha.textContent = serie.fecha;
          card.appendChild(fecha);
        } 

        const footer = document.createElement('div');
        footer.className = 'item-footer'; 

        const btn = document.createElement('button');
        btn.className = 'descripcion-btn';
        btn.textContent = 'Ver más';
        btn.onclick = () => abrirModal(i, lista);
        footer.appendChild(btn); 

        const etiqueta = document.createElement('span');
        etiqueta.className = 'estado-serie';
        switch (serie.seccion) {
          case 'vistas':
            etiqueta.textContent = 'Vista';
            etiqueta.style.color = '#22c55e';
            etiqueta.style.backgroundColor = '#d4f8d4';
            break;
          case 'no-vistas':
            etiqueta.textContent = 'No vista';
            etiqueta.style.color = '#ef4444';
            etiqueta.style.backgroundColor = '#fcdada';
            break;
          case 'proximas':
            etiqueta.textContent = 'Próxima';
            etiqueta.style.color = '#facc15';
            etiqueta.style.backgroundColor = '#fff9c4';
            break;
          default:
            etiqueta.textContent = '';
            etiqueta.style.backgroundColor = 'transparent';
        }
        footer.appendChild(etiqueta); 

        card.appendChild(footer);
        cont.appendChild(card);
      });

      // skeleton para las imágenes
      document.querySelectorAll('.item img').forEach((img) => {
        img.classList.add('loading');
        img.addEventListener('load', () => img.classList.remove('loading'));
      });
    } 

    function filtrarSeries() {
      const busqueda = document.getElementById('buscador').value.toLowerCase();
      const seccion = document.getElementById('filtro-seccion').value;
      const plataforma = document.getElementById('filtro-plataforma').value;
      const filtradas = datos.filter((s) => {
        return (
          (!busqueda || s.titulo.toLowerCase().includes(busqueda)) &&
          (!seccion || s.seccion === seccion) &&
          (!plataforma || s.plataforma === plataforma)
        );
      });
      renderSeries(filtradas);
    } 

    function abrirModal(index, lista) {
      indiceModal = index;
      window.listaActual = lista;
      const serie = lista[index]; 

      const fechaHTML =
        serie.seccion === 'proximas' && serie.fecha
          ? `<p><strong>Fecha:</strong> ${serie.fecha}</p>`
          : ''; 

      const imagenHTML = `
        <img
          src="${serie.imgURL}"
          alt="${serie.titulo}"
          loading="lazy"
          onclick="reemplazarPorTrailer('${encodeURIComponent(serie.trailerURL || '')}', '${encodeURIComponent(serie.titulo)}')"
        />
      `; 

      document.getElementById('modal-content').innerHTML = `
        ${imagenHTML}
        <h2 id="modal-title">${serie.titulo}</h2>
        <p id="modal-desc"><strong>Plataforma:</strong> ${serie.plataforma}</p>
        ${fechaHTML}
        <p>${serie.descripcion}</p>
      `; 

      document.getElementById('overlay').style.display = 'flex';
      document.getElementById('modal-content').focus();
      ocultarFechaModalSiNoProximas();
    } 

    function reemplazarPorTrailer(trailerURLEnc, tituloEnc) {
      const url = decodeURIComponent(trailerURLEnc || '');
      if (!url) return; 

      const cont = document.getElementById('modal-content');
      const img = cont.querySelector('img');
      if (!img) return; 

      const titulo = decodeURIComponent(tituloEnc || 'Tráiler'); 

      img.outerHTML = `
        <div class="modal-video">
          <iframe
            src="${url}"
            title="Tráiler de ${titulo}"
            loading="lazy"
            allow="autoplay; fullscreen; picture-in-picture; web-share; encrypted-media"
            allowfullscreen
          ></iframe>
        </div>
      `;
    } 

    function ocultarFechaModalSiNoProximas() {
      try {
        const contenido = document.getElementById('modal-content');
        const texto = contenido?.textContent?.toLowerCase() || '';
        if (!texto.includes('próximas') && !texto.includes('proximas')) {
          [...contenido.querySelectorAll('*')].forEach((el) => {
            const t = (el.textContent || '').toLowerCase();
            if (
              t.startsWith('fecha:') ||
              (el.className && el.className.toLowerCase().includes('fecha'))
            ) {
              el.remove();
            }
          });
        }
      } catch (e) {}
    } 

    function cerrarModal() {
      document.getElementById('overlay').style.display = 'none';
      const contenido = document.getElementById('modal-content');
      contenido.innerHTML = '';
    } 

    function navegarModal(dir) {
      indiceModal += dir;
      if (indiceModal < 0) indiceModal = window.listaActual.length - 1;
      if (indiceModal >= window.listaActual.length) indiceModal = 0;
      abrirModal(indiceModal, window.listaActual);
    } 

    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape') {
        cerrarModal();
      }
    }); 

    // Cargar JSON al iniciar
    async function cargarDatos() {
      try {
        const resp = await fetch(URL_JSON);
        if (!resp.ok) {
          throw new Error('Error HTTP ' + resp.status);
        }
        const data = await resp.json();
        datos = data;
        filtrarSeries(); // inicial
      } catch (err) {
        console.error('Error cargando JSON:', err);
      }
    }

    document.addEventListener('DOMContentLoaded', cargarDatos);
  </script>
</body>
</html>